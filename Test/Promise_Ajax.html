<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Promise对象实现Ajax操作</title>
  </head>
  <body>
    <input type="text" name="" value="">
    <script type="text/javascript">
      var getJSON=function(url){
        var promise =new Promise(function(resolve,reject){
          var client=new XMLHttpRequest();
          client.open("GET", url);
      client.onreadystatechange = handler;
      client.responseType = "json";
      client.setRequestHeader("Accept", "application/json");
      client.send();

          function handler(){
            if(this.readyState!==4){
              return;
            }
          }
          if(this.status==200){
            resolve(this.response);
          }else{
            reject(new Error(this.satusText));
          }
        });
        return promise;
      }
      var input=document.getElementsByTagName('input')[0];
      getJSON('//api.mis.dev.gegebox.com/v1/users?name='+'').then((json) => {
        input.value=json.name;
      },(error)=>{
        console.log('出错了',error);
      })
    </script>
  </body>
</html>
