<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>拍照上传图片</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="format-detection" content="telephone=no, email=no" />
    <!--<link href="css/style.css" rel="stylesheet" type="text/css">-->
    <link rel="stylesheet" href="css/index.css" type="text/css">
    <link rel="stylesheet" href="fonts/iconfont/iconfont.css">
    <!--[if IE]>
<script src="js/html5shiv.min.js"></script>
<![endif]-->
</head>

<body>
    <!--头部-->
    <div class="htmleaf-container">
        <div id="clipArea"></div>
        <div class="footer">
            <span id="cancle">取消</span>
            <span id="finish" class="fr">完成</span>
        </div>
        <div id="view">

        </div>
    </div>
    <div class="main">
        <div id="user_head">
            <a id="left_ico" href="javascript:history.go(-1);">
                <i class="icon iconfont">&#xe67f;</i>
            </a>
            <p>制作中</p>
        </div>
        <div class="nav">
            <div class="btn active"><span>1.制作</span></div>
            <div class="btn"><span>2.选择柜机</span></div>
        </div>
        <div class="show">
            <div>
                <div class="img">
                    <div id="uploadBox">
                        <a href="javascript:void(0);" id="upload">
                            <div class="btn"><span>上传图片</span></div>
                            <input id="file" type="file" onchange="javascript:setImagePreview();" accept="image/*" multiple />
                        </a>
                        <p>建议上传1M以上 清晰度高的图片</p>
                    </div>
                    <div id="error">
                        <p>咣咣，上传失败/(ㄒoㄒ)/~~</p>
                        <div class="btn" id="retry"><span>重试</span></div>
                        <a href="javascript:void(0);"><label for="file">重选作品
                        <input id="file" type="file" onchange="javascript:setImagePreview();" accept="image/*" multiple />
                        
                        </label></a>
                    </div>
                    <div id="photo"></div>
                </div>

                <div class="text">

                    <p class="txt1">点击输入文字</p>


                    <div class="text_1">
                        <textarea maxlength="140" id="text" rows="2"></textarea>
                        <p id="num1"><span id="word">0</span>/140</p>
                    </div>


                </div>
            </div>
            <div class="nextBtn"><span>下一步</span></div>
        </div>
    </div>










    <script src="js/jquery.min.js" type="text/javascript"></script>
    <script>
        window.jQuery || document.write('<script src="js/jquery-2.1.1.min.js"><\/script>')

    </script>
    <script src="js/iscroll-zoom.js"></script>
    <script src="js/hammer.js"></script>
    <script src="js/jquery.photoclip.js"></script>
    <script>
        $(function() {
            $('#text').keyup(function() {
                var len = $(this).val().length;
                if (len > 139) {
                    alert('您输入超出了限制');
                }
                var num = 140 - len;
                $("#word").text(len);
            });
            $("#upload").click(function() {
                $(".htmleaf-container").fadeIn(300);
                $("#photo").show();
            })
            $("#cancle").click(function() {
                $(".htmleaf-container").fadeOut(300);
                $("#photo").hide();
            })

            $(".txt1").click(function() {
                $(this).hide();
                $(".text_1").show();
            })
            //删除图片
            $("#photo").click(function() {
                $(this).empty();
                $("#uploadBox").show();
                $("#photo").hide();
            })

        })

    </script>
    <script>
        var obUrl = ''
        //document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);
        $("#clipArea").photoClip({
            width: 290,
            height: 310,
            file: "#file",
            view: "#view",
            ok: "#finish",
            loadStart: function() {
                console.log("照片读取中");
            },
            loadComplete: function() {
                console.log("照片读取完成");
            },
            clipFinish: function(dataURL) {
                console.log(dataURL);
            }
        });

    </script>
    <script>
        $(function() {

            $("#finish").click(function() {
                $("#uploadBox").hide();
                $("#photo").empty();
                $('#photo').append('<img src="' + imgsource + '" align="absmiddle"  id="img_s">');
                $(".htmleaf-container").hide();
            })
        });

    </script>


    <script type="text/javascript">
        function setImagePreview() {
            var preview, img_txt, localImag, file_head = document.getElementById("file_head"),
                picture = file_head.value;
            if (!picture.match(/.jpg|.gif|.png|.bmp/i)) return alert("您上传的图片格式不正确，请重新选择！"), !1;
            if (preview = document.getElementById("preview"), file_head.files && file_head.files[0]) preview.style.display = "block",
                preview.style.width = "100px",
                preview.style.height = "100px",
                preview.src = window.navigator.userAgent.indexOf("Chrome") >= 1 || window.navigator.userAgent.indexOf("Safari") >= 1 ? window.webkitURL.createObjectURL(file_head.files[0]) : window.URL.createObjectURL(file_head.files[0]);
            else {
                file_head.select(),
                    file_head.blur(),
                    img_txt = document.selection.createRange().text,
                    localImag = document.getElementById("localImag"),
                    localImag.style.width = "100px",
                    localImag.style.height = "100px";
                try {
                    localImag.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale)",
                        localImag.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src = img_txt
                } catch (f) {
                    return alert("您上传的图片格式不正确，请重新选择！"), !1
                }
                preview.style.display = "none",
                    document.selection.empty()
            }
            return document.getElementById("DivUp").style.display = "block", !0
        }

    </script>


</body>

</html>
