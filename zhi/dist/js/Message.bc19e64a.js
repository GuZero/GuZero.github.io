webpackJsonp([12],{119:function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"message"},[a("HeaderBar",{attrs:{title:t.pageTitle,noborder:!0}}),a("div",{staticClass:"nav top44 fixed"},[a("div",{staticClass:"left tab rel",class:{active:0==t.activeTab},on:{click:function(e){t.switchTab(0)}}},[t._m(0)]),a("div",{staticClass:"left tab rel",class:{active:1==t.activeTab},on:{click:function(e){t.switchTab(1)}}},[a("div",[a("label",[t._v("工单")]),a("label",[a("span",[t._v("(")]),a("span",{staticClass:"num"},[t._v(t._s(t.task_num))]),a("span",[t._v(")")])])])]),a("div",{staticClass:"left tab rel",class:{active:2==t.activeTab},on:{click:function(e){t.switchTab(2)}}},[t._m(1)]),a("div",{staticClass:"left tab rel",class:{active:3==t.activeTab},on:{click:function(e){t.switchTab(3)}}},[t._m(2)])]),a("div",{staticClass:"mt44 pt50"},[t.list.length<=0&&!t.isFirst?[t._m(3)]:t._e(),t.list.length>0?[1==t.activeTab?t._l(t.list,function(e,s){return a("div",{key:e.id,staticClass:"list"},[a("div",{staticClass:"item rel",on:{click:function(a){a.stopPropagation(),a.preventDefault(),t.goDetail(e.id,e.href,s)}}},[a("p",{staticClass:"time"},[t._v(t._s(t._f("converTime")(e.created_at)))]),a("div",{staticClass:"rel info"},[a("i",{class:{unreadStatus:t.converReadTime(e.readed_at)}}),a("div",{staticClass:"detail"},[a("div",{staticClass:"flag"},[t._v(t._s(e.type))]),a("div",{staticClass:"title"},[t._v(t._s(e.content))]),a("div",{staticClass:"line f12 rel"},[a("label",{staticClass:"gray rel desc"},[t._v("终端名称:")]),a("label",[t._v(t._s(e.terminal_name))])]),a("div",{staticClass:"line f12 rel"},[a("label",{staticClass:"gray rel desc"},[t._v("创建时间:")]),a("label",[t._v(t._s(e.created_at))])])])])])])}):t._e(),2==t.activeTab?t._l(t.list2,function(e){return a("div",{key:e.id,staticClass:"list"},[a("div",{staticClass:"item rel"},[a("p",{staticClass:"time"},[t._v("8月10日 10:30 ")]),a("div",{staticClass:"rel info"},[a("i",{class:{unreadStatus:!t.read}}),t._m(4,!0)])])])}):t._e()]:t._e()],2),a("DataLoading",{ref:"loading"})],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("label",[t._v("预警")]),a("label")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("label",[t._v("告警")]),a("label")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("label",[t._v("合同")]),a("label")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"empty"},[a("img",{staticClass:"empty-img",attrs:{src:"//img.aimoge.com/FuBwJB9xafDv2zrrJWQDq3sKYXyp"}}),a("div",{staticClass:"empty-info"},[t._v("暂无消息通知")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"detail"},[a("div",{staticClass:"title"},[t._v("青山湾花园格格货栈")]),a("div",{staticClass:"line f12 rel"},[a("label",{staticClass:"gray rel desc"},[t._v("告警时间:")]),a("label",[t._v("2016-09-21 19:40:30")])]),a("div",{staticClass:"line f12 rel"},[a("label",{staticClass:"gray rel desc"},[t._v("告警内容:")]),a("label",[t._v("开门失败")])]),a("div",{staticClass:"line f12 rel"},[a("label",{staticClass:"gray rel desc"},[t._v("格口编码:")]),a("label",[t._v("M0420")])])])}]},t.exports.render._withStripped=!0},136:function(t,e,a){var s=a(99);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a(4)("2e9794b0",s,!1)},35:function(t,e,a){a(136);var s=a(1)(a(78),a(119),"data-v-aff66454",null);s.options.__file="D:\\moge\\zhichengxitong\\src\\pages\\Message.vue",s.esModule&&Object.keys(s.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),s.options.functional&&console.error("[vue-loader] Message.vue: functional components are not supported with templates, they should use render functions."),t.exports=s.exports},78:function(t,e,a){"use strict";(function(t,s){function i(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var n,o=a(7),l=a.n(o),r=a(8),c=a.n(r);e.default=n={data:function(){return{pageTitle:"消息中心",bodyBg:"gray",btnconfig:{isgoback:0,ismsg:1,issearch:1},version:"1",activeTab:1,warn_num:"0",task_num:"0",alarm_num:"0",contract_num:"0",filter:"",page:1,total_page:1,scroll_load_loading:!1,scroll_load_end:!1,isFirst:!0,list:[],list0:[],list1:[],list2:[],list3:[]}},mixins:[a(6)],components:{HeaderBar:l.a,DataLoading:c.a},mounted:function(){window.canGoBack=!0,window.origin=null,window.addEventListener("scroll",this.handleScroll)},activated:function(){window.canGoBack=!0,window.origin=null,"1"===window.localStorage.messageToOther&&"1"!=window.localStorage.homeToMessage?document.body.scrollTop=window.localStorage.messageScrollTop:(this.activeTab=1,this.warn_num="0",this.task_num="0",this.alarm_num="0",this.contract_num="0",this.filter="",this.resetData(),this.switchTab(1)),window.addEventListener("scroll",this.handleScroll),window.localStorage.removeItem("messageScrollTop"),window.localStorage.removeItem("homeToMessage")},beforeRouteEnter:function(t,e,a){a()},beforeRouteUpdate:function(t,e,a){},beforeRouteLeave:function(t,e,a){"/"!==t.path&&(window.localStorage.setItem("messageToOther","1"),window.localStorage.removeItem("homeToMessage"),window.localStorage.setItem("messageScrollTop",document.body.scrollTop)),a()}},i(n,"beforeRouteLeave",function(t,e,a){"/message"==t.path&&window.localStorage.setItem("homeToMessage","1"),a()}),i(n,"destroyed",function(){}),i(n,"filters",{converTime:function(t){return t?(t=t.toString(),parseInt(t.substring(5,7))+"月"+parseInt(t.substring(8,10))+"日 "+t.substring(11,16)):""}}),i(n,"methods",{handleScroll:function(){document.body.scrollTop+window.innerHeight>=document.body.scrollHeight-1&&this.fetchData()},showLoading:function(){this.scroll_load_loading=!0,this.$refs.loading&&this.$refs.loading.showLoading()},hideLoading:function(){this.scroll_load_loading=!1,this.$refs.loading&&this.$refs.loading.hideLoading()},showLoadEnd:function(){this.hideLoading(),this.scroll_load_end=!0,this.$refs.loading&&this.$refs.loading.showEnd()},formatDate:function(t){var e=new Date(t),a=e.getFullYear(),s=e.getMonth()+1,i=e.getDate(),n=e.getHours(),o=e.getMinutes(),l=e.getSeconds();s<10&&(s="0"+s),i<10&&(i="0"+i),n<10&&(n="0"+n),o<10&&(o="0"+o),l<10&&(l="0"+l);var r=a+"-"+s+"-"+i+" "+n+":"+o+":"+l;return r},converReadTime:function(t){return t?(t=t.toString(),"-"==t.substring(0,1)||"0000"==t.substring(0,4)):""},resetData:function(){this.page=1,this.total_page=1,this.isFirst=!0,this.scroll_load_loading=!1,this.scroll_load_end=!1,this.list=[],this.list0=[],this.list1=[],this.list2=[],this.list3=[]},switchTab:function(e){if(0==e||2==e||3==e)return t.showErrorTip("敬请期待！"),!1;switch(e>-1?this.activeTab=e:void 0,e){case 0:this.filter="warn";break;case 1:this.filter="tasks";break;case 2:this.filter="alarm";break;case 3:this.filter="contract";break;default:this.filter="tasks"}this.resetData(),this.fetchData()},fetchData:function(){var e=this;return!e.scroll_load_loading&&(!e.scroll_load_end&&(!(e.total_page<e.page)&&(e.isFirst&&1==e.page&&(document.body.scrollTop=0),e.isFirst&&getAjaxRequest("message_cache",s.messages+"numbers",e.version,5e3,216e5,function(a){0==a.status?(e.warn_num=a.data.warn,e.task_num=a.data.task,e.alarm_num=a.data.alarm,e.contract_num=a.data.contract):a.msg&&t.showErrorTip(a.msg)},function(t){}),e.showLoading(),void getAjaxRequest("message_cache",s.messages+e.filter+"?page="+e.page,e.version,5e3,216e5,function(a){if(0==a.status){switch(e.activeTab){case 0:e.list0=e.list0.concat(a.data.news),e.list=e.list0;break;case 1:e.list1=e.list1.concat(a.data.news),e.list=e.list1;break;case 2:e.list2=e.list2.concat(a.data.news),e.list=e.list2;break;case 3:e.list3=e.list3.concat(a.data.news),e.list=e.list3;break;default:e.list1=e.list1.concat(a.data.news),e.list=e.list1}e.total_page=a.total_page,e.page+=1,!e.isFirst&&(a.data.news.length<16||e.page>a.total_page)?e.showLoadEnd():e.hideLoading(),e.isFirst=!1}else e.hideLoading(),a.msg&&t.showErrorTip(a.msg)},function(a){e.hideLoading(),t.showErrorTip("您的网络可能出了点问题:(")}))))},goDetail:function(e,a,i){var n=this,o=n.list[i];return a?n.converReadTime(o.readed_at)?void axios.post(s.messages+n.filter,{message_id:e},{withCredentials:!0,headers:{"Content-Type":"application/json"}}).then(function(e){if(0==e.data.status){var s=(new Date,n.list[i]);s.readed_at=n.formatDate(),n.list.splice(i,1,s),n.url(a)}else e.data.msg&&t.showErrorTip(e.data.msg)}).catch(function(e){t.showErrorTip("您的网络可能出了点问题:(")}):(n.url(a),!1):(t.showErrorTip("您的工单已被删除"),!1)}}),n}).call(e,a(0),a(2))},99:function(t,e,a){e=t.exports=a(3)(),e.push([t.i,"\n.message[data-v-aff66454] {\n  background-color: #eee;\n}\n.message .pt50[data-v-aff66454] {\n    padding-top: 43px;\n}\n.message .nav[data-v-aff66454] {\n    background-color: #fafafa;\n    border-bottom: 1px #cfcfcf solid;\n    width: 100%;\n    box-sizing: border-box;\n    -webkit-box-sizing: border-box;\n}\n.message .nav .num[data-v-aff66454] {\n      color: #d75a48;\n}\n.message .nav .tab[data-v-aff66454] {\n      width: 25%;\n      height: 42px;\n      line-height: 42px;\n      text-align: center;\n}\n.message .nav .tab[data-v-aff66454]:active {\n        background-color: #eee;\n}\n.message .nav .tab.active[data-v-aff66454] {\n        color: #07689f;\n}\n.message .nav .tab.active .num[data-v-aff66454] {\n          color: #07689f;\n}\n.message .nav .tab.active[data-v-aff66454]:after {\n          content: '';\n          display: block;\n          position: absolute;\n          bottom: 0;\n          left: 50%;\n          border: 1px #07689f solid;\n          width: 40px;\n          margin-left: -20px;\n}\n.message .empty[data-v-aff66454] {\n    padding-top: 64px;\n}\n.message .empty .empty-img[data-v-aff66454] {\n      display: block;\n      width: 144px;\n      height: 144px;\n      margin: 0 auto 16px;\n}\n.message .empty .empty-info[data-v-aff66454] {\n      font-size: 14px;\n      color: #6e6e6e;\n      text-align: center;\n}\n.message .item[data-v-aff66454] {\n    padding: 24px 16px 0 16px;\n}\n.message .item .time[data-v-aff66454] {\n      display: block;\n      width: 135px;\n      height: 18px;\n      line-height: 18px;\n      margin: 0 auto 8px;\n      text-align: center;\n      background-color: #cfcfcf;\n      border-radius: 10px;\n      color: #fff;\n      font-size: 12px;\n}\n.message .item .gray[data-v-aff66454] {\n      color: #6e6e6e;\n}\n.message .item .flag[data-v-aff66454] {\n      font-size: 14px;\n      color: #07689f;\n}\n.message .item .info[data-v-aff66454] {\n      padding-left: 16px;\n}\n.message .item .info .unreadStatus[data-v-aff66454] {\n        position: absolute;\n        top: 0;\n        left: 0;\n        height: 8px;\n        width: 8px;\n        border-radius: 100%;\n        background-color: #d75a48;\n}\n.message .item .info .detail[data-v-aff66454] {\n        background-color: #fff;\n        border-radius: 10px;\n        padding: 8px 16px;\n        color: #323232;\n}\n.message .item .info .detail .title[data-v-aff66454] {\n          font-size: 14px;\n          margin-bottom: 8px;\n          font-weight: 700;\n}\n.message .item .info .detail .line[data-v-aff66454] {\n          padding-left: 60px;\n          min-height: 22px;\n}\n.message .item .info .detail .desc[data-v-aff66454] {\n          position: absolute;\n          top: 0;\n          left: 0;\n          display: block;\n          width: 60px;\n          height: 14px;\n}\n",""])}});