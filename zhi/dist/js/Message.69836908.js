webpackJsonp([12],{119:function(t,a,e){t.exports={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"message"},[e("HeaderBar",{attrs:{title:t.pageTitle,noborder:!0}}),e("div",{staticClass:"nav top44 fixed"},[e("div",{staticClass:"left tab rel",class:{active:0==t.activeTab},on:{click:function(a){t.switchTab(0)}}},[t._m(0)]),e("div",{staticClass:"left tab rel",class:{active:1==t.activeTab},on:{click:function(a){t.switchTab(1)}}},[e("div",[e("label",[t._v("工单")]),e("label",[e("span",[t._v("(")]),e("span",{staticClass:"num"},[t._v(t._s(t.task_num))]),e("span",[t._v(")")])])])]),e("div",{staticClass:"left tab rel",class:{active:2==t.activeTab},on:{click:function(a){t.switchTab(2)}}},[t._m(1)]),e("div",{staticClass:"left tab rel",class:{active:3==t.activeTab},on:{click:function(a){t.switchTab(3)}}},[t._m(2)])]),e("div",{staticClass:"mt44 pt50"},[t.list.length<=0&&!t.isFirst?[t._m(3)]:t._e(),t.list.length>0?[1==t.activeTab?t._l(t.list,function(a,s){return e("div",{staticClass:"list"},[e("div",{staticClass:"item rel",on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.goDetail(a.id,a.href,s)}}},[e("p",{staticClass:"time"},[t._v(t._s(t._f("converTime")(a.created_at)))]),e("div",{staticClass:"rel info"},[e("i",{class:{unreadStatus:t.converReadTime(a.readed_at)}}),e("div",{staticClass:"detail"},[e("div",{staticClass:"flag"},[t._v(t._s(a.type))]),e("div",{staticClass:"title"},[t._v(t._s(a.content))]),e("div",{staticClass:"line f12 rel"},[e("label",{staticClass:"gray rel desc"},[t._v("终端名称:")]),e("label",[t._v(t._s(a.terminal_name))])]),e("div",{staticClass:"line f12 rel"},[e("label",{staticClass:"gray rel desc"},[t._v("创建时间:")]),e("label",[t._v(t._s(a.created_at))])])])])])])}):t._e(),2==t.activeTab?t._l(t.list2,function(a){return e("div",{staticClass:"list"},[e("div",{staticClass:"item rel"},[e("p",{staticClass:"time"},[t._v("8月10日 10:30 ")]),e("div",{staticClass:"rel info"},[e("i",{class:{unreadStatus:!t.read}}),t._m(4,!0)])])])}):t._e()]:t._e()],2),e("DataLoading",{ref:"loading"})],1)},staticRenderFns:[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("label",[t._v("预警")]),e("label")])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("label",[t._v("告警")]),e("label")])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("label",[t._v("合同")]),e("label")])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"empty"},[e("img",{staticClass:"empty-img",attrs:{src:"//img.aimoge.com/FuBwJB9xafDv2zrrJWQDq3sKYXyp"}}),e("div",{staticClass:"empty-info"},[t._v("暂无消息通知")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"detail"},[e("div",{staticClass:"title"},[t._v("青山湾花园格格货栈")]),e("div",{staticClass:"line f12 rel"},[e("label",{staticClass:"gray rel desc"},[t._v("告警时间:")]),e("label",[t._v("2016-09-21 19:40:30")])]),e("div",{staticClass:"line f12 rel"},[e("label",{staticClass:"gray rel desc"},[t._v("告警内容:")]),e("label",[t._v("开门失败")])]),e("div",{staticClass:"line f12 rel"},[e("label",{staticClass:"gray rel desc"},[t._v("格口编码:")]),e("label",[t._v("M0420")])])])}]},t.exports.render._withStripped=!0},136:function(t,a,e){var s=e(99);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);e(4)("2e9794b0",s,!1)},35:function(t,a,e){e(136);var s=e(1)(e(78),e(119),"data-v-aff66454",null);s.options.__file="D:\\moge\\zhichengxitong\\src\\pages\\Message.vue",s.esModule&&Object.keys(s.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),s.options.functional&&console.error("[vue-loader] Message.vue: functional components are not supported with templates, they should use render functions."),t.exports=s.exports},78:function(t,a,e){"use strict";(function(t,s){var i=e(7),n=e.n(i),o=e(9),l=e.n(o),r=e(8),c=e.n(r);a.default={mixins:[e(6)],data:function(){return{pageTitle:"消息中心",bodyBg:"gray",btnconfig:{isgoback:0,ismsg:1,issearch:1},version:"1",isGoHome:!1,activeTab:1,warn_num:"0",task_num:"0",alarm_num:"0",contract_num:"0",filter:"",page:1,total_page:1,scroll_load_loading:!1,scroll_load_end:!1,isFirst:!0,list:[],list0:[],list1:[],list2:[],list3:[]}},components:{HeaderBar:n.a,FooterBar:l.a,DataLoading:c.a},mounted:function(){window.canGoBack=!0,window.origin=null,this.isGoHome=!1,this.switchTab(1),window.addEventListener("scroll",this.handleScroll)},activated:function(){window.canGoBack=!0,window.origin=null,"1"===window.localStorage.messageToHome?(this.activeTab=1,this.warn_num="0",this.task_num="0",this.alarm_num="0",this.contract_num="0",this.filter="",this.resetData(),this.switchTab(1)):document.body.scrollTop=window.localStorage.messageScrollTop,window.localStorage.removeItem("messageScrollTop"),window.localStorage.removeItem("messageToHome"),window.addEventListener("scroll",this.handleScroll)},beforeRouteEnter:function(t,a,e){e()},beforeRouteUpdate:function(t,a,e){},beforeRouteLeave:function(t,a,e){"/"===t.path?window.localStorage.setItem("messageToHome","1"):(window.localStorage.removeItem("messageToHome"),window.localStorage.setItem("messageScrollTop",document.body.scrollTop),document.body.scrollTop=0),e()},destroyed:function(){},filters:{converTime:function(t){return t?(t=t.toString(),parseInt(t.substring(5,7))+"月"+parseInt(t.substring(8,10))+"日 "+t.substring(11,16)):""}},methods:{handleScroll:function(){document.body.scrollTop+window.innerHeight>=document.body.scrollHeight-1&&this.fetchData()},showLoading:function(){this.scroll_load_loading=!0,this.$refs.loading&&this.$refs.loading.showLoading()},hideLoading:function(){this.scroll_load_loading=!1,this.$refs.loading&&this.$refs.loading.hideLoading()},showLoadEnd:function(){this.hideLoading(),this.scroll_load_end=!0,this.$refs.loading&&this.$refs.loading.showEnd()},formatDate:function(t){var a=new Date(t),e=a.getFullYear(),s=a.getMonth()+1,i=a.getDate(),n=a.getHours(),o=a.getMinutes(),l=a.getSeconds();s<10&&(s="0"+s),i<10&&(i="0"+i),n<10&&(n="0"+n),o<10&&(o="0"+o),l<10&&(l="0"+l);var r=e+"-"+s+"-"+i+" "+n+":"+o+":"+l;return r},converReadTime:function(t){return t?(t=t.toString(),"-"==t.substring(0,1)||"0000"==t.substring(0,4)):""},resetData:function(){this.page=1,this.isFirst=!0,this.scroll_load_loading=!1,this.scroll_load_end=!1,this.list=[],this.list0=[],this.list1=[],this.list2=[],this.list3=[]},switchTab:function(a){if(0==a||2==a||3==a)return t.showErrorTip("敬请期待！"),!1;switch(a>-1?this.activeTab=a:void 0,a){case 0:this.filter="warn";break;case 1:this.filter="tasks";break;case 2:this.filter="alarm";break;case 3:this.filter="contract";break;default:this.filter="tasks"}this.resetData(),this.fetchData()},fetchData:function(){if("/message"!=this.$route.path)return!1;var a=this;return a.total_page<a.page?(a.showLoadEnd(),!1):!a.scroll_load_loading&&(!a.scroll_load_end&&(1==a.page&&(document.body.scrollTop=0),a.isFirst&&getAjaxRequest("message_cache",s.messages+"numbers",a.version,12e4,216e5,function(e){0==e.status?(a.warn_num=e.data.warn,a.task_num=e.data.task,a.alarm_num=e.data.alarm,a.contract_num=e.data.contract):e.msg&&t.showErrorTip(e.msg)},function(a){t.showErrorTip("当前无网络，请检查您的网络状态！")}),a.showLoading(),void getAjaxRequest("message_cache",s.messages+a.filter+"?page="+a.page,a.version,1e4,216e5,function(e){if(0==e.status){switch(a.activeTab){case 0:a.list0=a.list0.concat(e.data.news),a.list=a.list0;break;case 1:a.list1=a.list1.concat(e.data.news),a.list=a.list1;break;case 2:a.list2=a.list2.concat(e.data.news),a.list=a.list2;break;case 3:a.list3=a.list3.concat(e.data.news),a.list=a.list3;break;default:a.list1=a.list1.concat(e.data.news),a.list=a.list1}a.total_page=e.total_page,a.isFirst=!1,a.page+=1,e.data.news.length<16||a.page>e.total_page?a.showLoadEnd():a.hideLoading()}else a.hideLoading(),e.msg&&t.showErrorTip(e.msg)},function(e){a.hideLoading(),t.showErrorTip("当前无网络，请检查您的网络状态！")})))},goDetail:function(a,e,i){var n=this,o=n.list[i];return e?n.converReadTime(o.readed_at)?void axios.post(s.messages+n.filter,{message_id:a},{withCredentials:!0,headers:{"Content-Type":"application/json"}}).then(function(a){if(0==a.data.status){var s=(new Date,n.list[i]);s.readed_at=n.formatDate(),n.list.splice(i,1,s),n.url(e)}else a.data.msg&&t.showErrorTip(a.data.msg)}).catch(function(a){t.showErrorTip("当前无网络，请检查您的网络状态！")}):(n.url(e),!1):(t.showErrorTip("您的工单已被删除"),!1)}}}}).call(a,e(0),e(2))},99:function(t,a,e){a=t.exports=e(3)(),a.push([t.i,"\n.message .pt50[data-v-aff66454] {\n  padding-top: 43px;\n}\n.message .nav[data-v-aff66454] {\n  background-color: #fafafa;\n  border-bottom: 1px #cfcfcf solid;\n  width: 100%;\n  box-sizing: border-box;\n  -webkit-box-sizing: border-box;\n}\n.message .nav .num[data-v-aff66454] {\n    color: #d75a48;\n}\n.message .nav .tab[data-v-aff66454] {\n    width: 25%;\n    height: 42px;\n    line-height: 42px;\n    text-align: center;\n}\n.message .nav .tab[data-v-aff66454]:active {\n      background-color: #eee;\n}\n.message .nav .tab.active[data-v-aff66454] {\n      color: #07689f;\n}\n.message .nav .tab.active .num[data-v-aff66454] {\n        color: #07689f;\n}\n.message .nav .tab.active[data-v-aff66454]:after {\n        content: '';\n        display: block;\n        position: absolute;\n        bottom: 0;\n        left: 50%;\n        border: 1px #07689f solid;\n        width: 40px;\n        margin-left: -20px;\n}\n.message .empty[data-v-aff66454] {\n  padding-top: 64px;\n}\n.message .empty .empty-img[data-v-aff66454] {\n    display: block;\n    width: 144px;\n    height: 144px;\n    margin: 0 auto 16px;\n}\n.message .empty .empty-info[data-v-aff66454] {\n    font-size: 14px;\n    color: #6e6e6e;\n    text-align: center;\n}\n.message .item[data-v-aff66454] {\n  padding: 24px 16px 0 16px;\n}\n.message .item .time[data-v-aff66454] {\n    display: block;\n    width: 135px;\n    height: 18px;\n    line-height: 18px;\n    margin: 0 auto 8px;\n    text-align: center;\n    background-color: #cfcfcf;\n    border-radius: 10px;\n    color: #fff;\n    font-size: 12px;\n}\n.message .item .gray[data-v-aff66454] {\n    color: #6e6e6e;\n}\n.message .item .flag[data-v-aff66454] {\n    font-size: 14px;\n    color: #07689f;\n}\n.message .item .info[data-v-aff66454] {\n    padding-left: 16px;\n}\n.message .item .info .unreadStatus[data-v-aff66454] {\n      position: absolute;\n      top: 0;\n      left: 0;\n      height: 8px;\n      width: 8px;\n      border-radius: 100%;\n      background-color: #d75a48;\n}\n.message .item .info .detail[data-v-aff66454] {\n      background-color: #fff;\n      border-radius: 10px;\n      padding: 8px 16px;\n      color: #323232;\n}\n.message .item .info .detail .title[data-v-aff66454] {\n        font-size: 14px;\n        margin-bottom: 8px;\n        font-weight: 700;\n}\n.message .item .info .detail .line[data-v-aff66454] {\n        padding-left: 60px;\n        min-height: 22px;\n}\n.message .item .info .detail .desc[data-v-aff66454] {\n        position: absolute;\n        top: 0;\n        left: 0;\n        display: block;\n        width: 60px;\n        height: 14px;\n}\n",""])}});